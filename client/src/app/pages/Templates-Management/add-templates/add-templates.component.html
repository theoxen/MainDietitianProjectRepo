<!-- Main container for the template form with styling class -->
<div class="form-container">
    <!-- Page title -->
    <h2 class="title">Add New Template</h2>
    <!-- Form with reactive form binding and submission handler -->
    <form [formGroup]="addTemplateForm" (ngSubmit)="addTemplate()">
      <!-- Header section for template basic information -->
      <div class="template-header">
        <!-- Template name input with validation -->
        <div class="template-info-row">
          <label for="templateName">Template Name:</label>
          <input id="templateName" type="text" formControlName="name" placeholder="Enter template name" class="form-control" />
          <!-- Error message that displays only when name field is invalid and touched -->
          <div class="error-feedback" [hidden]="addTemplateForm.controls['name'].valid || !addTemplateForm.controls['name'].touched">
            Name is required
          </div>
        </div>
      </div>
      <!-- Main meal planning section with 7-day week layout -->
      <div class="template-days-section">
        <!-- Table with days as columns and meal types as rows -->
        <table class="horizontal-template-table">
          <thead>
            <tr>
              <!-- Table headers for meal types and days of week -->
              <th class="meal-type-header">Meal Type</th>
              <th>Monday</th>
              <th>Tuesday</th>
              <th>Wednesday</th>
              <th>Thursday</th>
              <th>Friday</th>
              <th>Saturday</th>
              <th>Sunday</th>
            </tr>
          </thead>
          <tbody>
            <!-- Breakfast row - first meal type (index 0) -->
            <tr>
              <td class="meal-type">Breakfast</td>
              <td>
                <!-- Text area bound to form control using getDayMealControl(dayIndex, mealTypeIndex) -->
                <!-- First parameter (0) is Monday, second parameter (0) is Breakfast -->
                <textarea [formControl]="getDayMealControl(0, 0)" class="compact-textarea" placeholder="Monday breakfast"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(1, 0)" class="compact-textarea" placeholder="Tuesday breakfast"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(2, 0)" class="compact-textarea" placeholder="Wednesday breakfast"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(3, 0)" class="compact-textarea" placeholder="Thursday breakfast"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(4, 0)" class="compact-textarea" placeholder="Friday breakfast"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(5, 0)" class="compact-textarea" placeholder="Saturday breakfast"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(6, 0)" class="compact-textarea" placeholder="Sunday breakfast"></textarea>
              </td>
            </tr>
            
            <!-- Morning Snack row - second meal type (index 1) -->
            <tr>
              <td class="meal-type">Morning Snack</td>
              <td>
                <!-- Each textarea is connected to a specific day/meal combination in the form -->
                <textarea [formControl]="getDayMealControl(0, 1)" class="compact-textarea" placeholder="Monday morning snack"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(1, 1)" class="compact-textarea" placeholder="Tuesday morning snack"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(2, 1)" class="compact-textarea" placeholder="Wednesday morning snack"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(3, 1)" class="compact-textarea" placeholder="Thursday morning snack"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(4, 1)" class="compact-textarea" placeholder="Friday morning snack"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(5, 1)" class="compact-textarea" placeholder="Saturday morning snack"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(6, 1)" class="compact-textarea" placeholder="Sunday morning snack"></textarea>
              </td>
            </tr>
            
            <!-- Lunch row - third meal type (index 2) -->
            <tr>
              <td class="meal-type">Lunch</td>
              <td>
                <textarea [formControl]="getDayMealControl(0, 2)" class="compact-textarea" placeholder="Monday lunch"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(1, 2)" class="compact-textarea" placeholder="Tuesday lunch"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(2, 2)" class="compact-textarea" placeholder="Wednesday lunch"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(3, 2)" class="compact-textarea" placeholder="Thursday lunch"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(4, 2)" class="compact-textarea" placeholder="Friday lunch"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(5, 2)" class="compact-textarea" placeholder="Saturday lunch"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(6, 2)" class="compact-textarea" placeholder="Sunday lunch"></textarea>
              </td>
            </tr>
            
            <!-- Afternoon Snack row - fourth meal type (index 3) -->
            <tr>
              <td class="meal-type">Afternoon Snack</td>
              <td>
                <textarea [formControl]="getDayMealControl(0, 3)" class="compact-textarea" placeholder="Monday afternoon snack"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(1, 3)" class="compact-textarea" placeholder="Tuesday afternoon snack"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(2, 3)" class="compact-textarea" placeholder="Wednesday afternoon snack"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(3, 3)" class="compact-textarea" placeholder="Thursday afternoon snack"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(4, 3)" class="compact-textarea" placeholder="Friday afternoon snack"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(5, 3)" class="compact-textarea" placeholder="Saturday afternoon snack"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(6, 3)" class="compact-textarea" placeholder="Sunday afternoon snack"></textarea>
              </td>
            </tr>
            
            <!-- Dinner row - fifth meal type (index 4) -->
            <tr>
              <td class="meal-type">Dinner</td>
              <td>
                <textarea [formControl]="getDayMealControl(0, 4)" class="compact-textarea" placeholder="Monday dinner"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(1, 4)" class="compact-textarea" placeholder="Tuesday dinner"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(2, 4)" class="compact-textarea" placeholder="Wednesday dinner"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(3, 4)" class="compact-textarea" placeholder="Thursday dinner"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(4, 4)" class="compact-textarea" placeholder="Friday dinner"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(5, 4)" class="compact-textarea" placeholder="Saturday dinner"></textarea>
              </td>
              <td>
                <textarea [formControl]="getDayMealControl(6, 4)" class="compact-textarea" placeholder="Sunday dinner"></textarea>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- Form action buttons section -->
      <div class="form-actions">
        <!-- Submit button calls the addTemplate() method when clicked -->
        <button type="submit" class="primary-button">Add Template</button>
        <!-- Cancel button calls the cancel() method to abort template creation -->
        <button type="button" class="secondary-button" (click)="cancel()">Cancel</button>
      </div>
    </form>
    <!-- Success and error message containers that show conditionally -->
    <div class="success-message" [hidden]="!successMessage">{{successMessage}}</div>
    <div class="error-message" [hidden]="!errorMessage">{{errorMessage}}</div>
  </div>