<!-- Main container for the template editing form -->
<div class="form-container">
    <!-- Page title -->
    <h2 class="title">Edit Template</h2>
    
    <!-- Form using Angular's reactive forms with formGroup binding and submission handler -->
    <form [formGroup]="editTemplateForm" (ngSubmit)="updateTemplate()">
      <!-- Template name section -->
      <div class="template-header">
        <div class="template-info-row">
          <label for="templateName">Template Name:</label>
          <!-- Input field for template name with form control binding -->
          <input id="templateName" type="text" formControlName="name" placeholder="Enter template name" class="form-control" />
        </div>
        <!-- Error message that displays only when name field is invalid and touched -->
        <div class="error-feedback" [hidden]="editTemplateForm.controls['name'].valid || !editTemplateForm.controls['name'].touched">
          Name is required
        </div>
      </div>
  
      <!-- Weekly meal plan section with 7-day table layout -->
      <div class="template-days-section">
        <!-- Table with days of week as columns and meal types as rows -->
        <table class="horizontal-template-table">
          <thead>
            <tr>
              <!-- Column headers for meal type and days of the week -->
              <th class="meal-type-header">Meal Type</th>
              <th>Monday</th>
              <th>Tuesday</th>
              <th>Wednesday</th>
              <th>Thursday</th>
              <th>Friday</th>
              <th>Saturday</th>
              <th>Sunday</th>
            </tr>
          </thead>
          <tbody>
            <!-- Breakfast Row - First meal type (index 0) -->
            <tr>
              <td class="meal-type">Breakfast</td>
              <!-- Monday breakfast - getDayMealControl(0,0) gets the form control for day 0 (Monday), meal type 0 (Breakfast) -->
              <td>
                <textarea 
                  [formControl]="getDayMealControl(0, 0)" 
                  class="compact-textarea" 
                  placeholder="Monday breakfast"></textarea>
              </td>
              <!-- Tuesday breakfast - day index 1, meal type index 0 -->
              <td>
                <textarea 
                  [formControl]="getDayMealControl(1, 0)" 
                  class="compact-textarea" 
                  placeholder="Tuesday breakfast"></textarea>
              </td>
              <!-- Wednesday breakfast - day index 2, meal type index 0 -->
              <td>
                <textarea 
                  [formControl]="getDayMealControl(2, 0)" 
                  class="compact-textarea" 
                  placeholder="Wednesday breakfast"></textarea>
              </td>
              <!-- Thursday breakfast - day index 3, meal type index 0 -->
              <td>
                <textarea 
                  [formControl]="getDayMealControl(3, 0)" 
                  class="compact-textarea" 
                  placeholder="Thursday breakfast"></textarea>
              </td>
              <!-- Friday breakfast - day index 4, meal type index 0 -->
              <td>
                <textarea 
                  [formControl]="getDayMealControl(4, 0)" 
                  class="compact-textarea" 
                  placeholder="Friday breakfast"></textarea>
              </td>
              <!-- Saturday breakfast - day index 5, meal type index 0 -->
              <td>
                <textarea 
                  [formControl]="getDayMealControl(5, 0)" 
                  class="compact-textarea" 
                  placeholder="Saturday breakfast"></textarea>
              </td>
              <!-- Sunday breakfast - day index 6, meal type index 0 -->
              <td>
                <textarea 
                  [formControl]="getDayMealControl(6, 0)" 
                  class="compact-textarea" 
                  placeholder="Sunday breakfast"></textarea>
              </td>
            </tr>
            
            <!-- Morning Snack Row - Second meal type (index 1) -->
            <tr>
              <td class="meal-type">Morning Snack</td>
              <!-- Each cell contains a textarea bound to a form control for the specific day/meal combination -->
              <td>
                <textarea 
                  [formControl]="getDayMealControl(0, 1)" 
                  class="compact-textarea" 
                  placeholder="Monday morning snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(1, 1)" 
                  class="compact-textarea" 
                  placeholder="Tuesday morning snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(2, 1)" 
                  class="compact-textarea" 
                  placeholder="Wednesday morning snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(3, 1)" 
                  class="compact-textarea" 
                  placeholder="Thursday morning snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(4, 1)" 
                  class="compact-textarea" 
                  placeholder="Friday morning snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(5, 1)" 
                  class="compact-textarea" 
                  placeholder="Saturday morning snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(6, 1)" 
                  class="compact-textarea" 
                  placeholder="Sunday morning snack"></textarea>
              </td>
            </tr>
            
            <!-- Lunch Row - Third meal type (index 2) -->
            <tr>
              <td class="meal-type">Lunch</td>
              <!-- The getDayMealControl method dynamically retrieves the correct form control from the form structure -->
              <td>
                <textarea 
                  [formControl]="getDayMealControl(0, 2)" 
                  class="compact-textarea" 
                  placeholder="Monday lunch"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(1, 2)" 
                  class="compact-textarea" 
                  placeholder="Tuesday lunch"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(2, 2)" 
                  class="compact-textarea" 
                  placeholder="Wednesday lunch"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(3, 2)" 
                  class="compact-textarea" 
                  placeholder="Thursday lunch"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(4, 2)" 
                  class="compact-textarea" 
                  placeholder="Friday lunch"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(5, 2)" 
                  class="compact-textarea" 
                  placeholder="Saturday lunch"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(6, 2)" 
                  class="compact-textarea" 
                  placeholder="Sunday lunch"></textarea>
              </td>
            </tr>
            
            <!-- Afternoon Snack Row - Fourth meal type (index 3) -->
            <tr>
              <td class="meal-type">Afternoon Snack</td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(0, 3)" 
                  class="compact-textarea" 
                  placeholder="Monday afternoon snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(1, 3)" 
                  class="compact-textarea" 
                  placeholder="Tuesday afternoon snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(2, 3)" 
                  class="compact-textarea" 
                  placeholder="Wednesday afternoon snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(3, 3)" 
                  class="compact-textarea" 
                  placeholder="Thursday afternoon snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(4, 3)" 
                  class="compact-textarea" 
                  placeholder="Friday afternoon snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(5, 3)" 
                  class="compact-textarea" 
                  placeholder="Saturday afternoon snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(6, 3)" 
                  class="compact-textarea" 
                  placeholder="Sunday afternoon snack"></textarea>
              </td>
            </tr>
            
            <!-- Dinner Row - Fifth meal type (index 4) -->
            <tr>
              <td class="meal-type">Dinner</td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(0, 4)" 
                  class="compact-textarea" 
                  placeholder="Monday dinner"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(1, 4)" 
                  class="compact-textarea" 
                  placeholder="Tuesday dinner"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(2, 4)" 
                  class="compact-textarea" 
                  placeholder="Wednesday dinner"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(3, 4)" 
                  class="compact-textarea" 
                  placeholder="Thursday dinner"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(4, 4)" 
                  class="compact-textarea" 
                  placeholder="Friday dinner"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(5, 4)" 
                  class="compact-textarea" 
                  placeholder="Saturday dinner"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(6, 4)" 
                  class="compact-textarea" 
                  placeholder="Sunday dinner"></textarea>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <!-- Form action buttons section -->
      <div class="form-actions">
        <!-- Submit button that triggers the updateTemplate() method when clicked -->
        <button type="submit" class="primary-button">Update Template</button>
        <!-- Cancel button that calls the cancel() method when clicked -->
        <button type="button" class="secondary-button" (click)="cancel()">Cancel</button>
      </div>
    </form>
    
    <!-- Feedback messages section -->
    <!-- Success message shown only when successMessage has value (conditional display) -->
    <div class="success-message" [hidden]="!successMessage">
      {{ successMessage }}
    </div>
    
    <!-- Error message shown only when errorMessage has value (conditional display) -->
    <div class="error-message" [hidden]="!errorMessage">
      {{ errorMessage }}
    </div>
  </div>