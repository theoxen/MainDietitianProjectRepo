<!-- Main container for the diet editing form -->
<div class="form-container">
  <!-- Page title showing which client's diet is being edited -->
  <h2 class="title">Edit Diet for {{clientName}}</h2>
  
  <!-- Main form with reactive form binding to clientDiets FormGroup in the component -->
  <form [formGroup]="clientDiets" (ngSubmit)="submitEditedDiets()">
    <!-- Diet name section with validation -->
    <div class="diet-header">
      <div class="diet-info-row">
        <label for="dietName">Diet Name:</label>
        <!-- Input for diet name with form control binding -->
        <input id="dietName" type="text" formControlName="name" placeholder="Enter diet name" class="form-control" />
        <!-- Template checkbox commented out, may be used in future implementations -->
        <!-- <div class="template-checkbox">
          <label for="isTemplate">Template:</label>
          <input id="isTemplate" type="checkbox" formControlName="isTemplate" />
        </div> -->
      </div>
      <!-- Validation error message that shows when name field is invalid and touched -->
      <div class="error-feedback" [hidden]="clientDiets.controls['name'].valid || !clientDiets.controls['name'].touched">
        Name is required
      </div>
    </div>

    <!-- Diet plan weekly schedule section -->
    <div class="diet-days-section">
      <!-- Table layout with days as columns and meal types as rows -->
      <table class="horizontal-diet-table">
        <thead>
          <tr>
            <!-- Column headers for meal type and days of the week -->
            <th class="meal-type-header">Meal Type</th>
            <th>Monday</th>
            <th>Tuesday</th>
            <th>Wednesday</th>
            <th>Thursday</th>
            <th>Friday</th>
            <th>Saturday</th>
            <th>Sunday</th>
          </tr>
        </thead>
        <tbody>
          <!-- Each row represents a specific meal type across all days of the week -->
          <!-- Breakfast Row - Index 0 in meal types -->
          <tr>
            <td class="meal-type">Breakfast</td>
            <!-- Each cell contains a textarea bound to a specific form control -->
            <!-- getDayMealControl(dayIndex, mealTypeIndex) returns the appropriate FormControl -->
            <td>
              <textarea 
                [formControl]="getDayMealControl(0, 0)" 
                class="compact-textarea" 
                placeholder="Monday breakfast"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(1, 0)" 
                class="compact-textarea" 
                placeholder="Tuesday breakfast"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(2, 0)" 
                class="compact-textarea" 
                placeholder="Wednesday breakfast"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(3, 0)" 
                class="compact-textarea" 
                placeholder="Thursday breakfast"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(4, 0)" 
                class="compact-textarea" 
                placeholder="Friday breakfast"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(5, 0)" 
                class="compact-textarea" 
                placeholder="Saturday breakfast"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(6, 0)" 
                class="compact-textarea" 
                placeholder="Sunday breakfast"></textarea>
            </td>
          </tr>
          
          <!-- Morning Snack Row - Index 1 in meal types -->
          <tr>
            <td class="meal-type">Morning Snack</td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(0, 1)" 
                class="compact-textarea" 
                placeholder="Monday snack"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(1, 1)" 
                class="compact-textarea" 
                placeholder="Tuesday snack"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(2, 1)" 
                class="compact-textarea" 
                placeholder="Wednesday snack"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(3, 1)" 
                class="compact-textarea" 
                placeholder="Thursday snack"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(4, 1)" 
                class="compact-textarea" 
                placeholder="Friday snack"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(5, 1)" 
                class="compact-textarea" 
                placeholder="Saturday snack"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(6, 1)" 
                class="compact-textarea" 
                placeholder="Sunday snack"></textarea>
            </td>
          </tr>
          
          <!-- Lunch Row - Index 2 in meal types -->
          <tr>
            <td class="meal-type">Lunch</td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(0, 2)" 
                class="compact-textarea" 
                placeholder="Monday lunch"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(1, 2)" 
                class="compact-textarea" 
                placeholder="Tuesday lunch"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(2, 2)" 
                class="compact-textarea" 
                placeholder="Wednesday lunch"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(3, 2)" 
                class="compact-textarea" 
                placeholder="Thursday lunch"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(4, 2)" 
                class="compact-textarea" 
                placeholder="Friday lunch"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(5, 2)" 
                class="compact-textarea" 
                placeholder="Saturday lunch"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(6, 2)" 
                class="compact-textarea" 
                placeholder="Sunday lunch"></textarea>
            </td>
          </tr>
          
          <!-- Afternoon Snack Row - Index 3 in meal types -->
          <tr>
            <td class="meal-type">Afternoon Snack</td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(0, 3)" 
                class="compact-textarea" 
                placeholder="Monday afternoon snack"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(1, 3)" 
                class="compact-textarea" 
                placeholder="Tuesday afternoon snack"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(2, 3)" 
                class="compact-textarea" 
                placeholder="Wednesday afternoon snack"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(3, 3)" 
                class="compact-textarea" 
                placeholder="Thursday afternoon snack"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(4, 3)" 
                class="compact-textarea" 
                placeholder="Friday afternoon snack"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(5, 3)" 
                class="compact-textarea" 
                placeholder="Saturday afternoon snack"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(6, 3)" 
                class="compact-textarea" 
                placeholder="Sunday afternoon snack"></textarea>
            </td>
          </tr>
          
          <!-- Dinner Row - Index 4 in meal types -->
          <tr>
            <td class="meal-type">Dinner</td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(0, 4)" 
                class="compact-textarea" 
                placeholder="Monday dinner"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(1, 4)" 
                class="compact-textarea" 
                placeholder="Tuesday dinner"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(2, 4)" 
                class="compact-textarea" 
                placeholder="Wednesday dinner"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(3, 4)" 
                class="compact-textarea" 
                placeholder="Thursday dinner"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(4, 4)" 
                class="compact-textarea" 
                placeholder="Friday dinner"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(5, 4)" 
                class="compact-textarea" 
                placeholder="Saturday dinner"></textarea>
            </td>
            <td>
              <textarea 
                [formControl]="getDayMealControl(6, 4)" 
                class="compact-textarea" 
                placeholder="Sunday dinner"></textarea>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <!-- Action buttons for form submission and cancellation -->
    <div class="form-actions">
      <!-- Submit button triggers submitEditedDiets() method -->
      <button type="submit" class="primary-button">Update Diet</button>
      <!-- Cancel button calls cancel() method to abandon changes -->
      <button type="button" class="secondary-button" (click)="cancel()">Cancel</button>
    </div>
  </form>
  
  <!-- Feedback Messages Section -->
  <!-- Success message shown conditionally when operation succeeds -->
  <div class="success-message" [hidden]="!successMessage">
    {{ successMessage }}
  </div>
  
  <!-- Error message shown conditionally when operation fails -->
  <div class="error-message" [hidden]="!errorMessage">
    {{ errorMessage }}
  </div>
</div>