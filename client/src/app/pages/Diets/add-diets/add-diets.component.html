
  <div class="form-container">
    <h2 class="title">Add New Diet for {{clientName}}</h2>
    
    <form [formGroup]="addclientDietsForm" (ngSubmit)="addDiets()">
      <div class="diet-header">
        <div class="diet-info-row">
          <label for="dietName">Diet Name:</label>
          <input id="dietName" type="text" formControlName="name" placeholder="Enter diet name" class="form-control" />
          <div class="template-checkbox">
            <label for="isTemplate">Template:</label>
            <input id="isTemplate" type="checkbox" formControlName="isTemplate" />
          </div>
        </div>
        <div class="error-feedback" [hidden]="addclientDietsForm.controls['name'].valid || !addclientDietsForm.controls['name'].touched">
          Name is required
        </div>
      </div>
  
      <div class="diet-days-section">
        <!-- Horizontal table layout with days as columns -->
        <table class="horizontal-diet-table">
          <thead>
            <tr>
              <th class="meal-type-header">Meal Type</th>
              <th>Monday</th>
              <th>Tuesday</th>
              <th>Wednesday</th>
              <th>Thursday</th>
              <th>Friday</th>
              <th>Saturday</th>
              <th>Sunday</th>
            </tr>
          </thead>
          <tbody>
            <!-- Breakfast Row -->
            <tr>
              <td class="meal-type">Breakfast</td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(0, 0)" 
                  class="compact-textarea" 
                  placeholder="Monday breakfast"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(1, 0)" 
                  class="compact-textarea" 
                  placeholder="Tuesday breakfast"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(2, 0)" 
                  class="compact-textarea" 
                  placeholder="Wednesday breakfast"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(3, 0)" 
                  class="compact-textarea" 
                  placeholder="Thursday breakfast"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(4, 0)" 
                  class="compact-textarea" 
                  placeholder="Friday breakfast"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(5, 0)" 
                  class="compact-textarea" 
                  placeholder="Saturday breakfast"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(6, 0)" 
                  class="compact-textarea" 
                  placeholder="Sunday breakfast"></textarea>
              </td>
            </tr>
            
            <!-- Morning Snack Row -->
            <tr>
              <td class="meal-type">Morning Snack</td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(0, 3)" 
                  class="compact-textarea" 
                  placeholder="Monday snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(1, 3)" 
                  class="compact-textarea" 
                  placeholder="Tuesday snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(2, 3)" 
                  class="compact-textarea" 
                  placeholder="Wednesday snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(3, 3)" 
                  class="compact-textarea" 
                  placeholder="Thursday snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(4, 3)" 
                  class="compact-textarea" 
                  placeholder="Friday snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(5, 3)" 
                  class="compact-textarea" 
                  placeholder="Saturday snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(6, 3)" 
                  class="compact-textarea" 
                  placeholder="Sunday snack"></textarea>
              </td>
            </tr>
            
            <!-- Lunch Row -->
            <tr>
              <td class="meal-type">Lunch</td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(0, 1)" 
                  class="compact-textarea" 
                  placeholder="Monday lunch"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(1, 1)" 
                  class="compact-textarea" 
                  placeholder="Tuesday lunch"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(2, 1)" 
                  class="compact-textarea" 
                  placeholder="Wednesday lunch"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(3, 1)" 
                  class="compact-textarea" 
                  placeholder="Thursday lunch"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(4, 1)" 
                  class="compact-textarea" 
                  placeholder="Friday lunch"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(5, 1)" 
                  class="compact-textarea" 
                  placeholder="Saturday lunch"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(6, 1)" 
                  class="compact-textarea" 
                  placeholder="Sunday lunch"></textarea>
              </td>
            </tr>
            
            <!-- Afternoon Snack Row -->
            <tr>
              <td class="meal-type">Afternoon Snack</td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(0, 4)" 
                  class="compact-textarea" 
                  placeholder="Monday afternoon snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(1, 4)" 
                  class="compact-textarea" 
                  placeholder="Tuesday afternoon snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(2, 4)" 
                  class="compact-textarea" 
                  placeholder="Wednesday afternoon snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(3, 4)" 
                  class="compact-textarea" 
                  placeholder="Thursday afternoon snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(4, 4)" 
                  class="compact-textarea" 
                  placeholder="Friday afternoon snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(5, 4)" 
                  class="compact-textarea" 
                  placeholder="Saturday afternoon snack"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(6, 4)" 
                  class="compact-textarea" 
                  placeholder="Sunday afternoon snack"></textarea>
              </td>
            </tr>
            
            <!-- Dinner Row -->
            <tr>
              <td class="meal-type">Dinner</td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(0, 2)" 
                  class="compact-textarea" 
                  placeholder="Monday dinner"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(1, 2)" 
                  class="compact-textarea" 
                  placeholder="Tuesday dinner"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(2, 2)" 
                  class="compact-textarea" 
                  placeholder="Wednesday dinner"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(3, 2)" 
                  class="compact-textarea" 
                  placeholder="Thursday dinner"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(4, 2)" 
                  class="compact-textarea" 
                  placeholder="Friday dinner"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(5, 2)" 
                  class="compact-textarea" 
                  placeholder="Saturday dinner"></textarea>
              </td>
              <td>
                <textarea 
                  [formControl]="getDayMealControl(6, 2)" 
                  class="compact-textarea" 
                  placeholder="Sunday dinner"></textarea>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <div class="form-actions">
        <button type="button" class="template-button" (click)="openTemplateSelector()">
          <i class="fa-solid fa-file-import"></i> Use Template
        </button>
        <button type="submit" class="primary-button">Add Diet</button>
        <button type="button" class="secondary-button" (click)="cancel()">Cancel</button>
      </div>
    </form>


<!-- Template Selection Modal -->
<div class="template-modal" [style.display]="showTemplateSelector ? 'block' : 'none'">
  <div class="template-modal-content">
    <span class="close" (click)="closeTemplateSelector()">&times;</span>
    <h2>Select a Template</h2>
    
    <div class="templates-list">
      <div *ngIf="loading" class="loading">Loading templates...</div>
      <div *ngIf="templates.length === 0 && !loading" class="no-templates">
        No templates available
      </div>
      
      <table *ngIf="templates.length > 0">
        <thead>
          <tr>
            <th>Name</th>
            <th>Date</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let template of templates">
            <td>{{ template.name }}</td>
            <td>{{ formatDate(template.dateCreated) }}</td>
            <td>
              <button class="select-button" (click)="selectTemplate(template)">Select</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>





    
    <!-- Messages -->
    <div class="success-message" [hidden]="!successMessage">
      {{ successMessage }}
    </div>
    
    <div class="error-message" [hidden]="!errorMessage">
      {{ errorMessage }}
    </div>
  </div>
